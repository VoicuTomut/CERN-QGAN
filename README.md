<div align="center">
  
# CERN openlab Summer Student Project:<br>Quantum Generative Adversarial Networks on *ttH* Data Generation
  
  <a href="https://openlab.cern/education" target="_blank"><img height="45px" src="https://img.shields.io/badge/CERN%20openlab%20Summer%20Student-2021-5c5c5c?style=flat&labelColor=0033A0&logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAMAAABHPGVmAAAAPFBMVEVHcEz///////////////////////////////////////////////////////////////////////////+PybD1AAAAE3RSTlMAJkI02ugG+vLHDoyzoBlRXm18cLn1dwAAB1BJREFUeNqsVoea4ywMDL2b9v7v+gcEkU0gf7u5211/FI3KSPbrN+RFGI0x5Y4UV9A72A0EcV0/CCxLzhsutDpD3yFu4HccGagzuv4h7CmuDAx/CHsKXm/oSVH1gZkO8YC+QyE2tU6mTpOae5cjZYzG7DzH6HgmVwO5gz1AEV8cJHwYTKGXfCghezE3A3n9Z0Q+fXXMbsIkxYATisf/SCGznuk4itumQaOL/W3scN/BdVGA4kxTO8KPYzR4n3aXAyTCs7P9i7SKThZ/Lkyz5eWJQ2S7j57E0gdARwV4e8qV35JIB9Wg2ztNWKp+Qa3ymLAt1vC1XLoNw3Y3YhD1AO23GrmaSt26mnTnICc5IdQbFXCWImlelWWR8RMH9R+TSphQUqQ0phLuA8Aku9prm2nx1neX2HfYbprSxkVi768aWkBkO0VS9V5c2jV3M+k7jGlGODoJVn8BPD2klJq9JzHhFeq0IIlhoZC9UN1daHbxWpCvzqnmWk0UPaI49tw1I10HQGPnD4NMtODiYcgY+jqD6h6pxgGAbhv7FUiQKwfU2/2cYxKSkPjCsjY8aFqwbbpFOhNgFlQkHliuU8OXHshOODhkznBdwa8rQF0skCwND6ya7lp2aZxzVQSb89XJj1zLeup7nEa+cJznLRiEhlZpbXjMVv6+TeI/e40nNZQEeuZk0/DWY99YWsIbLjFLc04NOUfWHnPOici3yVBmcdveHLiagQiGTKMaS5j8qbb4GbfCd9HAs6kDwlnLh4TAW34NFUMBshoNtzY8VSAE/IpYoDk+u+42sEQ1DOU6iyr9eCxLw+eu8+lGVdx0LoUkpv/uC4KZj1AjRAJVBrrZNS+3NLyDE5C2auJlWVCVi97IOReXQztBY089NaMdMF1QlKElB6EsnxHSj8gcvrVkcrEZ849h5yYJsHTpG0xSwApr6p/tLQ2QWjNFjsuGxpQYkNAMIjKzOpJ1EhziFkMJBhsep8yIGWsFnEq1y/3emLM42x2SFCjXbaLrR8OD8YBKRhIAkAwY0iJUoAzfSCRopyFh+jvSQuIGidmQcCTxpK+LPEQ9vUoQ2m0AgMZWEvgryKMm3LngM6QZqg0kJApYwEiAEF/lz4a/Rk3AdTcoGOvLqC6tYdvyfj1pjARIsKAjX4IshfdyVi9J+A4SGkiktD1dvOiuvkECLDMSCFVT7G7kxEIZO8PUIdFsZjmC9+aN7pcDJ/ibio75gBLuyPi6W9/wYYY2Eq1U3UAQEK/Qs6RFTUtyNuityvWvTq1EOVYQCJaAIHKz//+vLxun2mPUMK/rjOXaMve0OXf4jpPW+QPsMyjcqHCpYAjwK56Kd7cRwQbU/aQ60mHmpPyH5Aa3GOfctxUFt4GMbxM9V7mDq+Gizno0ndTq2kPv35aoi9pQ1FRU0d8Y+f2rFGXRtRQS/pAZ/ZqLrJ7Ised4h23AiHvOl9bVChgw15jd18VdchF1E/Ov914NEyAvQtrtoRy3TYXT9qlsFKjXpe1vrxDcAM0Ync2XA4BxzPr75LZfSexVcDxUGaHbw1YwAkzDrIG43quM4CA0pdIPEcKVHRiTH6qMwCNkm4AfJnIPi0EsKKgyY2jovHXLBOI1+T6blnKsMgNA0AQU334eSdmCQgbTiyC81rgbeqV03Kzfb1YMyDHDVQaFGHNUwgBHduM7LDaYRPcMoLmjUtQ3f2fuErwEWOpn1F51gbGQ6BWpyFChzQQ7zYNBXOc9XBCkaXvh+lBIiSZlrBvPgJKAGzHZ6vl4Ol7uN6b41QjcX67PpOym635AVYaDnEaiz+L+TpVCoeLzxejOIZnvgzhgZL8/MTCFBTfdaUbJPgsxfp3iBwiPluoQqBWXBN+qUtpKUCbRBpbgiicoPvM1m+LrQfaSZauBGNf0emGYKg1N0OCYZ7lKc7doT2nBq/pQ1ZTXH+RJ10AMG1y7L8muvzc4M0HaBJbZ+B+YGdTE0ZlRtGEz8N1RCzGWeH6k+zimOjOOyX/eSTBIwr/+QWsmnfuJ470irR4Rha3sDLeY2EtEoj/orq8VPJ0j3PaNxYQfpBB6KzpbG9wtBz7uvJc93tA2FhdxfDDH/CBRRwyrb0HsV/5ZyDRcfOCATJFJ3ngP4lnfaM/Ol3XvhO4q6Ou0QH3+c9Zp3GvaU0zFst5/mLA6UIbOjYaI1wKujXOz4sam0/T2KzMZfSozSCivDt3xjUUpba9GLOeEAceaVYt7rQz5kAjSr3ao7NANQ2+th+QPq+sSFdulpZgCaM6Aw+zuWFQnOU16pDBJWdZi/4/E38oIi0n1YprM01HEsfTSk98+jxvjY2gKacfURjFyRJOyds3b/z087ciBp6OAo4/YAOkoxJrQpEaAdJRzfEY5kI4ijoAmNQRsjAJYGQfqbJVwoIGMQ5qOtsk5xOnY0EAEsFFUI6uYA+noRtOxzGggImAikXBIocfTURlsIEJA9hi4ExuIFJZ2nSESBw4hqnNY9N6hW2tKToAPkMdE+QcS1+0WlPAXfQAAAABJRU5ErkJggg==" /></a>

  <a href="https://qml-hep.github.io/qml_web/data/" target="_blank"><img alt="ttH Feynman Diagram" height="400px" src="https://raw.githubusercontent.com/eraraya-ricardo/CERN-QGAN/main/assets/ttH_feyndiag.png" /></a>
  
</div>

## Supervisor
[Dr. Sofia Vallecorsa](https://inspirehep.net/authors/1028732)

## Weekly Progress
- Week 1: Preprocessed the [optimal *ttH* dataset](https://drive.google.com/file/d/1qI-H4q8KGDggUg8YGMtrOGePfeCVGirx/view) (finding the two b-jets in the dataset with highest *pt*). Using this dataset, trained [Su Yeon's classical GANs](https://github.com/QML-HEP/qGAN/blob/main/1_classical_benchmark/ClassicalGAN.ipynb) and (modified) DijetGAN[[2](#references)].
- Week 2: Tested the cross-entropy loss for the generator, set Wasserstein distance as the evaluation metric, code and prepare the WGAN.
- Week 3: (on progress).

A specific weekly To-Do list is made every week as an [issue](https://github.com/eraraya-ricardo/CERN-QGAN/issues), covering all the comments and suggestions received during Friday meeting. When all the tasks in the To-Do list are done, the issue is marked as closed.

## Datasets[[1](#references)]
- [Downloads](https://qml-hep.github.io/qml_web/downloads/)
- [Visualization](https://qml-hep.github.io/qml_web/norm/)
- [Data Variable Details & Definitions](https://qml-hep.github.io/qml_web/data/)

## Dataset Preprocessing (Fixed)
1. Download the [optimal dataset](https://drive.google.com/file/d/1qI-H4q8KGDggUg8YGMtrOGePfeCVGirx/view).
2. Use only the training set, we don't need the validation and test set for training GAN models.
3. Take only the positive class (y = 1): the events which the Higgs are being produced, as we are not interested in reproducing the background data.
4. The 67 features in the dataset are arranged as follow:
    - > 1st jet, 2nd jet, 3rd jet, ..., 7th jet, MET, lepton
    - The jets in total have 7ùë•8=56 features, where every jet has 8 features, which are ordered as:<br>
       > ["pt", "eta", "phi", "en", "px", "py", "pz", "btag"]
    - MET has 4 features, which are ordered as:<br>
       > ["phi", "pt", "px", "py"]
    - lepton has 7 features, which are ordered as:<br>
       > ["pt", "eta", "phi", "en", "px", "py", "pz"]
5. We then preprocess the training set so that the training set contains:
     - Only the two b-jets (jets with btag=1) with the highest "pt".
     - For every jets, only keep the "pt", "eta", "phi", "en" features.

Notes:

    MET = missing transverse momentum
    lepton = (electron or muon)
    btag = either 1 or 0, 1 means the jet is the b-jet, 0 otherwise

> In total, the final training set should have 2ùë•4=8 features.

<p align="middle">
  <img src="https://github.com/eraraya-ricardo/CERN-QGAN/blob/main/assets/dataset_distribution.png" title="Training Set Distribution." /> <br>
  <a>Training Set Distribution.</a>
</p>

## Research
### Classical GANs
#### DijetGAN[[2](#references)] (Edo)
> Settings: optimal dataset, 200 epochs, batch size 128, optimizer as explained in reference [[2](#references)].

- generator loss: MSE

| Filter Size | Stride | Wasserstein distance |
| :---------: | :----: | :------------------: |
| 5 | 1 |  |
| 3 | 1 | 0.069790 |

- generator loss: cross-entropy

| Filter Size | Stride | Wasserstein distance |
| :---------: | :----: | :------------------: |
| 5 | 1 | 0.083107 |
| 3 | 1 | 0.045924 |

- WGAN but with DijetGAN architecture

| Filter Size | Stride | Wasserstein distance |
| :---------: | :----: | :------------------: |
| 5 | 1 |  |
| 3 | 1 |  |

## References
[1] [Vasileios Belis, Samuel Gonz√°lez-Castillo, Christina Reissel, Sofia Vallecorsa, El√≠as F. Combarro, G√ºnther Dissertori, & Florentin Reiter. (2021). Higgs analysis with quantum classifiers.](https://arxiv.org/abs/2104.07692)

[2] [Di Sipio, R., Giannelli, M. F., Haghighat, S. K., &amp; Palazzo, S. (2019). DijetGAN: a Generative-Adversarial Network approach for the simulation of QCD dijet events at the LHC. Journal of High Energy Physics, 2019(8).](https://link.springer.com/article/10.1007/JHEP08(2019)110)
